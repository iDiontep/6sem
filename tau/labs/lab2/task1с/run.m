clc;
clear all;
close all;

XMAX = 1000;                   % —Ä–∞–∑–º–µ—Ä —Å–µ—Ç–∫–∏ —Ä–∏—Å–æ–≤–∞–Ω–∏—è
STEP = 20;                 % —à–∞–≥ —Å–µ—Ç–∫–∏
TMAX = 5;                  % –≤—Ä–µ–º—è –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è

[x1, x2] = meshgrid(-XMAX: STEP: XMAX);

tic; % –æ—Å—Ç–∞–Ω–æ–≤–∫–∞  –∏ –∑–∞–ø—É—Å–∫ —Å–µ–∫—É–Ω–¥–æ–º–µ—Ä–∞
dx = @(t, x) moi_variant(t, x);
event_out_of_bounds = @(t, z) outOfBounds(t, z, XMAX+(STEP/5));
plotLocus(x1, x2, @moi_variant, event_out_of_bounds, TMAX); % —Å—Ç—Ä–æ–∏–º —Ñ–∞–∑–æ–≤—ã–µ —Ç—Ä–∞–µ–∫—Ç–æ—Ä–∏–∏
plotQuiver(x1, x2, @moi_variant); % —Å—Ç—Ä–æ–∏–º —Å—Ç—Ä–µ–ª–æ—á–∫–∏

toc;  % –æ—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–µ–∫—É–Ω–¥–æ–º–µ—Ä–∞



%% –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö —Ñ—É–Ω–∫—Ü–∏–π

function dxdt = moi_variant(t, x)
% —Ñ—É–Ω–∫—Ü–∏—è, –≤–æ–∑–≤—Ä–∞—â–∞—é—â–∞—è –≥—Ä–∞–¥–∏–µ–Ω—Ç 
% –≤ –Ω–µ–π –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∑–∞–¥–∞—Ç—å —É—Ä–∞–≤–Ω–µ–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã
%ùë•¬®‚àí ùë†ùëñùëõ(ùë•)ùë•Àô‚àí ùëôùëõ(1 + ùë•2) = 0
dxdt(1, :) = x(2, :);
dxdt(2, :) = x(2, :) .* sin(x(1, :))  + log(1+ power(x(1, :), 2)); 
end


